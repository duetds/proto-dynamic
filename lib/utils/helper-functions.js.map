{"version":3,"file":"helper-functions.js","sourceRoot":"","sources":["../../src/utils/helper-functions.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,oBAAoB,EAAqB,MAAM,qCAAqC,CAAA;AAC7F,OAAO,EAAE,MAAM,EAAiB,OAAO,EAAe,MAAM,6BAA6B,CAAA;AACzF,OAAO,EAAE,OAAO,EAAE,MAAM,KAAK,CAAA;AAO7B;;2DAE2D;AAE3D,MAAM,UAAU,aAAa,CAAC,GAAuB;IACnD,OAAO,CAAC,CAAC,GAAG,EAAE,QAAQ,CAAC,UAAU,CAAC,CAAA;AACpC,CAAC;AAED,MAAM,UAAU,qBAAqB,CAAC,IAAsB,EAAE,mBAA0C;IACtG,OAAO,mBAAmB,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,KAAK,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;AACvE,CAAC;AAED,MAAM,UAAU,UAAU,CAAC,IAAsB,EAAE,mBAA0C;IAC3F,MAAM,MAAM,GAAG,qBAAqB,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAA;IAC/D,OAAO,MAAM,EAAE,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,OAAO,CAAA;AAClD,CAAC;AAED,MAAM,UAAU,eAAe,CAAC,IAAsB,EAAE,mBAA0C;IAChG,MAAM,MAAM,GAAG,qBAAqB,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAA;IAC/D,MAAM,EAAE,YAAY,EAAE,EAAE,CAAA;AAC1B,CAAC;AAED;;2DAE2D;AAE3D,MAAM,kBAAkB,GAAG,CAAC,YAAoB,EAAE,EAAE;IAClD,QAAQ,YAAY,EAAE,CAAC;QACrB,KAAK,gBAAgB;YACnB,OAAO,SAAS,CAAA;QAClB,KAAK,gBAAgB;YACnB,OAAO,SAAS,CAAA;QAClB,KAAK,cAAc;YACjB,OAAO,OAAO,CAAA;QAChB,KAAK,YAAY;YACf,OAAO,SAAS,CAAA;QAClB,KAAK,aAAa;YAChB,OAAO,QAAQ,CAAA;QACjB;YACE,OAAO,SAAS,CAAA;IACpB,CAAC;AACH,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,cAAc,GAAG,CAAC,KAAoC,EAAE,IAA8B,EAAU,EAAE;IAC7G,IAAI,CAAC,KAAK;QAAE,OAAO,EAAE,CAAA;IAErB,MAAM,QAAQ,GAAiB,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;QACjD,CAAC,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,IAAI,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE;QACpD,CAAC,CAAC,KAAK,EAAE,QAAQ,KAAK,UAAU;YAC9B,CAAC,CAAC,KAAK;YACP,CAAC,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,IAAI,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,KAAK,CAAC,EAAE,CAAA;IAE1D,OAAO,oBAAoB,CAAW,QAAQ,EAAE;QAC9C,UAAU,EAAE;YACV,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAU,EAAE,CAAC,mBAAmB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,mBAAmB;YACpG,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAU,EAAE,CAAC,4BAA4B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB;YAC3G,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAU,EAAE,CAAC,4BAA4B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB;YAC3G,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAU,EAAE,CAAC,4BAA4B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB;YAC3G,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAU,EAAE,CAAC,4BAA4B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB;YAC3G,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAU,EAAE,CAAC,4BAA4B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB;YAC3G,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,EAAU,EAAE,CAAC,4BAA4B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB;YAC3G,CAAC,MAAM,CAAC,cAAc,CAAC,EAAE,IAAI,CAAC,EAAE;gBAC9B,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,CAAA;gBACxC,IAAI,CAAC,MAAM;oBAAE,OAAO,EAAE,CAAA;gBAEtB,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAA;gBACtD,QAAQ,MAAM,EAAE,CAAC;oBACf,KAAK,sBAAsB;wBACzB,OAAO,8BAA8B,MAAM,CAAC,OAAO,IAAI,EAAE,KAAK,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAA;oBAChH,KAAK,mBAAmB;wBACtB,OAAO,mBAAmB,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAA;oBAC1E;wBACE,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAA;gBACzD,CAAC;YACH,CAAC;YACD,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE,CAAC,IAAY,EAAE,EAAE;gBACzC,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,EAAE,MAAM,CAAA;gBAChC,IAAI,CAAC,MAAM;oBAAE,OAAO,EAAE,CAAA;gBAEtB,MAAM,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAA;gBAC5C,MAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,GAAG,CAAA;gBAC7B,MAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAA;gBAEjC,QAAQ,MAAM,EAAE,CAAC;oBACf,KAAK,2BAA2B;wBAC9B,OAAO,MAAM,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,IAAI,KAAK,GAAG,IAAI,CAAC,CAAA;oBAC5C,KAAK,gBAAgB;wBACnB,IAAI,KAAK,EAAE,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,KAAK,cAAc,EAAE,CAAC;4BACrD,OAAO;qBACA,MAAM,CAAC,MAAM,CAAC,IAAI;0BACb,kBAAkB,CAAC,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC;;;sCAGxC,KAAK,CAAC,GAAG,CAAC,EAAE,cAAc,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC;;;;kBAI1E,MAAM,CAAC,MAAM,CAAC,IAAI;2BACT,CAAA;wBACf,CAAC;wBACD,OAAO,EAAE,CAAA;oBACX;wBACE,OAAO,GAAG,MAAM,OAAO,GAAG,IAAI,CAAA;gBAClC,CAAC;YACH,CAAC;YACD,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,GAAW,EAAE,CAAC,+BAA+B;SAC3B;KAClC,CAAC,CAAA;AACJ,CAAC,CAAA","sourcesContent":["import { documentToHtmlString, type NodeRenderer } from \"@contentful/rich-text-html-renderer\"\nimport { BLOCKS, type Document, INLINES, type Inline } from \"@contentful/rich-text-types\"\nimport { nothing } from \"lit\"\nimport type { GroupItem } from \"../group/proto-dynamic-group\"\nimport type { ProtoButtonHandler, RichTextNode } from \"../hero/proto-dynamic-hero\"\nimport type { HighlightItem } from \"../highlight/proto-dynamic-highlight\"\n\ntype ButtonLinkedItem = GroupItem | HighlightItem\n\n/* -------------------------------------------------------\n * Proto button handlers & URL helpers\n * ----------------------------------------------------- */\n\nexport function isUrlExternal(url: string | undefined): boolean {\n  return !!url?.includes(\"https://\")\n}\n\nexport function getProtoButtonHandler(item: ButtonLinkedItem, protoButtonHandlers?: ProtoButtonHandler[]) {\n  return protoButtonHandlers?.find(b => b.buttonId === item.fields.key)\n}\n\nexport function getLinkUrl(item: ButtonLinkedItem, protoButtonHandlers?: ProtoButtonHandler[]) {\n  const button = getProtoButtonHandler(item, protoButtonHandlers)\n  return button?.url || item.fields.url || nothing\n}\n\nexport function handleLinkClick(item: ButtonLinkedItem, protoButtonHandlers?: ProtoButtonHandler[]) {\n  const button = getProtoButtonHandler(item, protoButtonHandlers)\n  button?.clickHandler?.()\n}\n\n/* -------------------------------------------------------\n * RichText content handler\n * ----------------------------------------------------- */\n\nconst transformVariation = (resourceType: string) => {\n  switch (resourceType) {\n    case \"button-primary\":\n      return \"primary\"\n    case \"button-default\":\n      return \"default\"\n    case \"button-plain\":\n      return \"plain\"\n    case \"link-plain\":\n      return \"default\"\n    case \"link-button\":\n      return \"button\"\n    default:\n      return \"default\"\n  }\n}\n\nexport const renderRichText = (input: RichTextNode | RichTextNode[], data?: Record<string, unknown>): string => {\n  if (!input) return \"\"\n\n  const document: RichTextNode = Array.isArray(input)\n    ? { nodeType: \"document\", data: {}, content: input }\n    : input?.nodeType === \"document\"\n      ? input\n      : { nodeType: \"document\", data: {}, content: [input] }\n\n  return documentToHtmlString(<Document>document, {\n    renderNode: {\n      [BLOCKS.PARAGRAPH]: (node, next): string => `<duet-paragraph>${next(node.content)}</duet-paragraph>`,\n      [BLOCKS.HEADING_1]: (node, next): string => `<duet-heading level=\"h1\">${next(node.content)}</duet-heading>`,\n      [BLOCKS.HEADING_2]: (node, next): string => `<duet-heading level=\"h2\">${next(node.content)}</duet-heading>`,\n      [BLOCKS.HEADING_3]: (node, next): string => `<duet-heading level=\"h3\">${next(node.content)}</duet-heading>`,\n      [BLOCKS.HEADING_4]: (node, next): string => `<duet-heading level=\"h4\">${next(node.content)}</duet-heading>`,\n      [BLOCKS.HEADING_5]: (node, next): string => `<duet-heading level=\"h5\">${next(node.content)}</duet-heading>`,\n      [BLOCKS.HEADING_6]: (node, next): string => `<duet-heading level=\"h6\">${next(node.content)}</duet-heading>`,\n      [BLOCKS.EMBEDDED_ENTRY]: node => {\n        const fields = node.data?.target?.fields\n        if (!fields) return \"\"\n\n        const typeId = node.data.target.sys.contentType.sys.id\n        switch (typeId) {\n          case \"componentCollapsible\":\n            return `<duet-collapsible heading=\"${fields.heading || \"\"}\">${renderRichText(fields.body)}</duet-collapsible>`\n          case \"componentShowMore\":\n            return `<duet-show-more>${renderRichText(fields.body)}</duet-show-more>`\n          default:\n            return fields.body ? renderRichText(fields.body) : \"\"\n        }\n      },\n      [INLINES.EMBEDDED_ENTRY]: (node: Inline) => {\n        const target = node.data?.target\n        if (!target) return \"\"\n\n        const typeId = target.sys.contentType.sys.id\n        const key = target.fields.key\n        const entry = target.fields.entry\n\n        switch (typeId) {\n          case \"componentRichTextVariable\":\n            return String(data?.[key] ?? `{{${key}}}`)\n          case \"buttonResource\":\n            if (entry?.sys.contentType.sys.id === \"dynamicModal\") {\n              return `<duet-button\n              icon=${target.fields.icon} \n              variation=${transformVariation(target.fields.richTextAppearance)}\n              margin=\"none\"\n              onclick='this.dispatchEvent(new CustomEvent(\"open-dynamic-modal\", {\n                detail: { entryId: \"${entry.sys.id}\", fields: ${JSON.stringify(entry.fields)} },\n                bubbles: true,\n                composed: true\n              }))'>\n                ${target.fields.text}\n            </duet-button>`\n            }\n            return \"\"\n          default:\n            return `${typeId}: {{${key}}}`\n        }\n      },\n      [BLOCKS.HR]: (): string => \"<duet-divider></duet-divider>\",\n    } as Record<string, NodeRenderer>,\n  })\n}\n"]}